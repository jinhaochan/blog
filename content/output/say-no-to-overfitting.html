<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Say NO to Overfitting!</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="A Pelican Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">A Pelican Blog </a></h1>
                <nav><ul>
                    <li><a href="/category/book-review.html">Book Review</a></li>
                    <li class="active"><a href="/category/data-science.html">Data Science</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/ramblings.html">Ramblings</a></li>
                    <li><a href="/category/review.html">Review</a></li>
                    <li><a href="/category/security.html">Security</a></li>
                    <li><a href="/category/software-engineering.html">Software Engineering</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/say-no-to-overfitting.html" rel="bookmark"
           title="Permalink to Say NO to Overfitting!">Say NO to Overfitting!</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-05-05T13:58:00+00:00">
                Published: Sun 05 May 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/jinhaochan.html">jinhaochan</a>
        </address>
<p>In <a href="/category/data-science.html">Data Science</a>.</p>
<p>tags: <a href="/tag/overfitting.html">Overfitting</a> </p>
</footer><!-- /.post-info -->      <!-- wp:paragraph -->

<p>Just some experience I've encountered while working on a very small data set of 1703 training samples, and 1705 testing samples.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->

<p>One way to combat overfitting is to use cross validation. While doing so, it's important for you not to just look at the final validation score, but also observe the training process itself.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->

<p>If we just look at the final CV result, we see an astounding <code>~92%</code> accuracy. This should raise some alarms that shout "Overfitting!". And this is an accurate observation, because when submitted to the Kaggle leader board, it got a measly <code>0.64</code>, which was below the baseline! And more horribly, the difference between CV and LB score is <code>~30%</code></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":294} -->

<figure class="wp-block-image">
![]({attach}media/2019/01/xgb2.png){.wp-image-294}

</figure>

<!-- /wp:image -->

<!-- wp:paragraph -->

<p>We can also observe the huge disparity between the training error and validation error. A training error of <code>0%</code>? And validation error of <code>~8%</code>? Something is really wrong.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->

<h3>Preventing overfitting in XGB</h3>
<!-- /wp:heading -->

<!-- wp:separator -->

<hr>
<!-- /wp:separator -->

<p></p>
<!-- wp:paragraph --></p>
<p>Since I've used XGBoost, there are several techniques available to combat overfitting, such as regularization, maximum depth of tree and bagging fractions. After applying all of those, I get a final CV score of <code>~74%</code>, but if we observe the disparity between the training error and validation error, the difference is only <code>~2%</code>!</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":293} -->

<figure class="wp-block-image">
![]({attach}media/2019/01/xgb1.png){.wp-image-293}

</figure>

<!-- /wp:image -->

<!-- wp:paragraph -->

<p>After uploading that to the leader board, I see my score rise up to <code>0.69</code>. The difference between my CV score and the LB is drop drastically from <code>~30%</code> to <code>~3%</code>! Classic example of overfitting.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->

<p>Aside from feature engineering, a lot of effort should also go into ensuring your model is not too complex for very simple data.</p>
<!-- /wp:paragraph -->
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>